---
title: 什么是哈希碰撞
createTime: 2025/06/20 22:50:47
permalink: /Webpack/0aislcs5/
---

## 哈希如何生成的

Webpack 生成哈希值的过程可以简化为以下关键步骤：

### 内容准备阶段

- 收集目标文件的所有内容（包括代码和依赖关系）
- 对模块内容进行标准化处理（移除空格/注释等不影响功能的差异）

### 哈希计算阶段

```javascript
// 简化的哈希计算逻辑
const crypto = require("crypto");

function generateHash(content) {
  return crypto
    .createHash("md5") // 使用MD5算法
    .update(content) // 输入内容
    .digest("hex") // 输出16进制格式
    .substring(0, 8); // 取前8位作为短哈希
}
```

### 输出应用阶段

- 将生成的哈希插入文件名：`main.[hash].js` → `main.a1b2c3d4.js`
- 不同哈希类型区别：
  - `[hash]`：基于整个构建
  - `[chunkhash]`：基于代码块内容
  - `[contenthash]`：基于文件完整内容

**典型示例**：

1. 文件内容：`console.log("Hello")`
2. 计算 MD5：`2ef7bde...`（完整哈希）
3. 截取使用：`2ef7bde8`
4. 生成文件：`main.2ef7bde8.js`

## 什么是哈希碰撞

哈希碰撞是指两个文件根据文件特征计算出的哈希值相同。如果文件本身重名，可能会导致严重的缓存和版本管理问题。

如果文件内容相同，一定会产生哈希碰撞，但是一般不会影响代码运行。

如果内容不相同，产生哈希碰撞的概率极低，如果遇到了，就可能会导致代码运行出错。

## 哈希碰撞的危害

哈希碰撞主要影响 Webpack 的 `emitAssets` 阶段，这个阶段会输出 bundle 到指定目录下。这时候如果遇到了完全同名的 bundle，可能会发生 ==**内容覆盖**== 的现象，即 **后生成的 bundle 会覆盖之前生成的 bundle**，最终只剩下一份。如果这些 bundle 的内容不相同，就意味着依赖这些 bundle 的代码在运行时可能会出现非常严重的问题。
