---
title: 变量
createTime: 2025/04/17 18:05:48
permalink: /Stylus/3rryom6v/
---

stylus 变量是一个可以存储值的标识符，类似于 JavaScript 中的变量。变量可以存储任何类型的值，包括数字、字符串、颜色、表达式、函数等。

## 一、变量的定义

变量的定义使用 `=` 符号，其形式如下：

```styl
变量名 = 值
```

例如：

```styl
$font-size = 14px
$color = #f00

body
  font-size $font-size
  color $color
```

编译为：

```css
body {
  font-size: 14px;
  color: #f00;
}
```

## 二、命名规范和建议

变量的命名规则，我们可以参考 JavaScript，主要包括以下几个方面：

1. 变量名应该是有意义的，能够清晰的表达变量的用途和含义

2. 变量名必须以字母、下划线 `_` 或 `$` 开头

3. 变量名可以包含字母、数字、下划线 `_` 或 `$`，不能包含空格或特殊字符

4. 变量名区分大小写，例如 `FontSize` 和 `fontsize` 是两个不同的变量

5. 变量名不能使用关键字和保留字作为变量名

::: tip 工作实践中的建议
在实际开发中，我们可以根据项目的需求和团队的约定来定义变量名。一般来说，为了提高代码的可读性和可维护性，我们建议遵循以下命名规范：

- 遵循 BEM 命名规范，使用短横线 `-` 和 下划线 `_` 分隔单词。例如：`$block__element--modifier`
- 强烈建议使用 `$` 开头，这样我们可以很容易区分变量和关键词。例如：`$font-size` 和 `font-size`。
- 常量建议使用全大写字母，单词之间使用下划线 `_` 分隔。例如：`$FONT_SIZE`, `$COLOR_PRIMARY`
- 全局变量建议使用 `$global-` 作为前缀。例如：`$global-font-size`
- 局部变量建议使用 `$local-` 作为前缀。例如：`$local-font-size`
- 按照模块将变量分组，可以使用特定前缀或哈希对象配合注释说明，也可以将变量拆分到不用文件中，以提高代码的可读性和可维护性。例如：`variables.styl`，`variables-theme.styl`，`variables-button.styl`

:::

## 三、变量的值

变量的值可以是任何类型的值，包括数字、字符串、颜色、哈希对象、表达式、函数等。

例如：

```styl
// 字符串
$font-size = 14px
// 字符串、列表
$font-stack = "Lucida Grande", Arial, sans-serif
// 颜色
$color = #f00
// 数字
$dialog-z-index = 999
// Hash对象
$theme-config = {
  theme: 'light',
  font-color: #333,
  fontSize: $font-size,
}
body
  color $theme-config.font-color
  font $font-size $font-stack
  a
    color $color
  #dialog
    z-index $dialog-z-index
```

编译为：

```css
body {
  color: #333;
  font: 14px "Lucida Grande", Arial, sans-serif;
}
body a {
  color: #f00;
}
body #dialog {
  z-index: 999;
}
```

## 四、高级特性

### 1、块级作用域（局部变量）

stylus 支持块级作用域，即变量只在当前块内有效，不会影响到其他块。

一般常见的块级作用域有：函数、混入、嵌套选择器、条件语句、循环语句、代码块。

例如：

```styl
$font-size = 14px
body
  font $font-size
  #dialog
    $font-size = 16px
    font $font-size
  #footer
    font $font-size
```

编译为：

```css
body {
  font: 14px;
}
body #dialog {
  font: 16px;
}
body #footer {
  font: 14px;
}
```

### 2、全局变量

stylus 支持全局变量，生效范围为整个 `.styl` 文件和依赖该`.styl`文件的`.styl`文件：
当我们在文件 a 中定义了全局变量，我们在文件 b 中导入文件 a，那么文件 a 中定义的全局变量也会在文件 b 中全局生效。

### 3、不存在 `!global` 关键字

Sass 中可以使用 `!global` 关键字强制将局部变量提升为全局变量。在 stylus 中，没有 `!global` 关键字，不存在变量的作用域提升这一概念。

### 4、向上冒泡查找变量

如果在当前块中没有找到指定变量，会向上冒泡查找距离当前块最近的变量。

例如：

```styl
$font-size = 12px
body
  $font-size = 14px
  div
    font $font-size
```

编译为：

```css
body div {
  font: 14px;
}
```

### 5、属性查找引用 `@`

stylus 支持属性引用，即可以通过 `@` 字符来引用前置属性的值。

```styl
div
  width 200px
  height @width
  #logo
    margin-left: (@width / 2)
    margin-top: (@height / 2)
```

编译为：

```css
div {
  width: 200px;
  height: 200px;
}
div #logo {
  margin-left: 100px;
  margin-top: 100px;
}
```

### 6、允许先使用后定义

stylus 支持先使用后定义，即可以在使用变量之前先定义变量。
例如：

```styl
body
  font $font-size
  $font-size = 14px
```

编译为：

```css
body {
  font: 14px;
}
```

### 7、变量查找的优先级

距离最近的局部变量 > 局部变量 > 全局变量 > 依赖文件中的全局变量

主要有以下几种情况：

1. 局部变量覆盖全局变量。
2. 不同的文件中存在同名的全局变量，后引用的生效。
3. 距离当前代码块最近的局部变量会覆盖掉距离远的局部变量。

我们不能使用`null`来创建空变量，但我么你可以使用括号()去做：

```styl
empty
=
()
body {
font: empty sans-serif;
}
```

编译为：

```css
body {
  font: sans-serif;
}
```

## 二、属性查找

Stylus 的另外一个很酷的独特功能是不需要分配值给变量就可以定义引用属性。下面是个很好的例子，元素水平垂直居中对齐（典型的方法是使用百分比和 margin 负值，如下）：

```styl
#logo
  position: absolute
  top: 50%
  left: 50%
  width: w = 150px
  height: h = 80px
  margin-left: -(w / 2)
  margin-top: -(h / 2)
```

无需定义变量 `w` 和 `h`，我们可以仅仅通过前置 `@` 字符在属性名前来访问该属性名对应的值：

另外使用案例是基于其他属性有条件地定义属性。在下面这个例子中，我们默认指定 z-index 值为 1，但是，只有在 z-index 之前未指定的时候才这样：

另一个使用场景是基于其他属性的存在情况来有条件地定义属性。在下面的例子中，我们默认设置`z-index`为`1`，只有在之前没有指定`z-index`时才这样做：

```styl
position()
  position: arguments
  z-index: 1 unless @z-index

#logo
  z-index: 20
  position: absolute

#logo2
  position: absolute
```

属性会“向上冒泡”查找堆栈直到被发现，或者返回 `null`（如果属性找不到）。下面这个例子，@color 最终成了 `blue`.

```styl
body
  color: red
  ul
    li
      color: blue
      a
        background-color: @color
```
