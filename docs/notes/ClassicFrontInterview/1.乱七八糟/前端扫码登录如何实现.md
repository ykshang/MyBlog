---
title: 前端扫码登录如何实现
createTime: 2025/07/05 10:36:48
permalink: /ClassicFrontInterview/f1zcc4a9/
---

## 业务场景分析

在一些需要用户登录的场景下，比如购物、支付、转账等，传统的用户名密码登录方式已经不再适用。而二维码登录是一种更加安全、方便的登录方式。

一般来说，完整的流程是：

```mermaid
sequenceDiagram
    participant 前端网页
    participant 服务端
    participant 移动App

    Note over 前端网页,服务端: 1. 生成二维码阶段
    前端网页->>服务端: 请求生成二维码
    服务端->>服务端: 生成唯一qrId和临时token
    服务端-->>前端网页: 返回qrId、token、过期时间
    前端网页->>前端网页: 渲染二维码(包含qrId&token)

    Note over 前端网页,服务端: 2. 轮询状态阶段
    前端网页->>服务端: 开始轮询/qr/status?qrId=xxx
    服务端-->>前端网页: 返回状态(pending)

    Note over 移动App,服务端: 3. 扫码验证阶段
    移动App->>移动App: 用户扫描二维码
    移动App->>移动App: 解析出qrId和token
    移动App->>服务端: 提交扫码确认(携带qrId,token,用户凭证)
    服务端->>服务端: 验证token有效性
    服务端->>服务端: 绑定qrId与用户身份
    服务端-->>移动App: 返回扫码成功确认

    Note over 前端网页,服务端: 4. 登录完成阶段
    服务端->>服务端: 更新qrId状态为confirmed
    前端网页->>服务端: 下次轮询请求
    服务端-->>前端网页: 返回状态(confirmed)和authToken
    前端网页->>前端网页: 保存authToken完成登录

    Note over 前端网页,移动App: 5. 结果通知阶段
    前端网页->>前端网页: 显示登录成功界面
    移动App->>移动App: 显示"登录成功"提示

```

## 前端请求临时 token

前端向后端请求生成临时 token，用于本次登录。后端将 token 生成以后存到数据库或者 redis 缓存。

## 前端生成二维码

前端根据临时 token 生成二维码。

二维码的本质就是点阵图，点阵图的每一个点有两种状态：黑和白。

## 前端轮询登录状态

前端轮询登录状态，即前端定时向后端请求登录状态。

## 完成登录

完成登录，即前端获取到登录凭证。
