---
title: action 方法
createTime: 2025/08/10 17:51:50
permalink: /Vue/r49ey8f6/
---

## 简介

Action 相当于组件中的 method。它们可以通过 defineStore() 中的 actions 属性来定义，并且它们也是定义业务逻辑的完美选择。

- 封装业务逻辑
- 处理异步操作
- 修改 store 状态
- 调用其他 actions 或 getters

## 定义方式

### 选项式 API

```ts
export const useCounterStore = defineStore("main", {
  state: () => ({
    count: 0,
  }),
  actions: {
    increment() {
      this.count++;
    },
    randomizeCounter() {
      this.count = Math.round(100 * Math.random());
    },
    add() {
      this.increment();
    },
  },
});
```

### 组合式 API

```ts
defineStore("store", () => {
  const count = ref(1);
  const double = () => count.value * 2;
  const add = (val) => (count.value += val);
  return { count, double };
});
```

## 使用

### 访问 store 实例内的其他方法属性

action 内部可以使用 this 来访问挂载到 store 上的 state、getter、action

```ts
export const useCounterStore = defineStore("main", {
  state: () => ({
    count: 0,
    name: "",
  }),
  actions: {
    increment() {
      this.count++;
    },
    changeName(name) {
      this.name = "";
    }
    reset() {
      this.increment();
      this.changeName("");
    },
  },
});
```

### 支持异步操作

```ts
export const useCounterStore = defineStore("main", {
  actions: {
    async fetchUserData(userId) {
      try {
        const response = await fetch(`/api/users/${userId}`)
        const data = await response.json()
        this.user = data
        return data // 可选择返回结果
      } catch (error) {
        throw new Error('Failed to fetch user data')
      }
    }
  }
}
```

### 访问其他 store

```ts
import { useOtherStore } from "./other-store";
const otherStore = useOtherStore();

export const useCounterStore = defineStore("main", {
  state: () => ({
    count: 0,
  }),
  actions: {
    increment() {
      this.count++;
      otherStore.count++;
    },
    add() {
      this.increment();
    },
  },
});
```
