---
title: åŸºç¡€ä»‹ç»
createTime: 2025/09/19 15:52:47
permalink: /Vue/l1wyrawd/
---
Unplugin Vue Router èƒ½å¸®ä½ **è‡ªåŠ¨ç”Ÿæˆè·¯ç”±**ï¼Œè®©ä½ ä»ç¹ççš„æ‰‹åŠ¨é…ç½®ä¸­è§£è„±å‡ºæ¥ï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚ä¸‹é¢æ˜¯ä¸€ä»½åŸºç¡€ä½¿ç”¨è¯´æ˜ï¼ŒåŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªè¡¨æ ¼ï¼Œå¸®ä½ å¿«é€Ÿäº†è§£ Unplugin Vue Router å¦‚ä½•æ ¹æ®æ–‡ä»¶ç»“æ„ç”Ÿæˆè·¯ç”±ï¼š

| æ–‡ä»¶è·¯å¾„                          | è®¿é—®è·¯å¾„ (Route)      | è¯´æ˜                                                                 |
| :-------------------------------- | :-------------------- | :------------------------------------------------------------------- |
| `src/pages/index.vue`             | `/`                   | é¦–é¡µ                                                                 |
| `src/pages/about.vue`             | `/about`              | å…³äºé¡µé¢                                                             |
| `src/pages/users/index.vue`       | `/users`              | ç”¨æˆ·åˆ—è¡¨é¡µ                                                             |
| `src/pages/users/[id].vue`        | `/users/:id`          | ç”¨æˆ·è¯¦æƒ…é¡µï¼Œ`[id]` ä¸º**å¿…éœ€å‚æ•°**                              |
| `src/pages/users/[[id]].vue`      | `/users/:id?`         | ç”¨æˆ·é¡µï¼Œ`[[id]]` ä¸º**å¯é€‰å‚æ•°**                                |
| `src/pages/articles/[slugs]+.vue` | `/articles/:slugs+`   | æ–‡ç« é¡µï¼Œ`[slugs]+` å¯åŒ¹é…**ä¸€ä¸ªæˆ–å¤šä¸ª**è·¯å¾„æ®µ                      |
| `src/pages/[...404].vue`          | `/*`                  | 404 é¡µé¢ï¼Œæ•è·æ‰€æœ‰æœªå®šä¹‰çš„è·¯ç”±                                  |
| `src/pages/parent.vue`            | `/parent`             | çˆ¶è·¯ç”±ç»„ä»¶ï¼Œéœ€åŒ…å« `<router-view>` ç”¨äºæ¸²æŸ“å­è·¯ç”±                   |
| `src/pages/parent/child.vue`      | `/parent/child`       | å­è·¯ç”±ç»„ä»¶ï¼Œè·¯å¾„ä¼šè‡ªåŠ¨åµŒå¥—                                      |

### ğŸ”§ å®‰è£…ä¸é…ç½®

1.  **å®‰è£…æ’ä»¶**
    åœ¨ä½ çš„ Vue 3 é¡¹ç›®ä¸­ï¼Œé€šè¿‡ npm æˆ– yarn ç­‰åŒ…ç®¡ç†å™¨å®‰è£… `unplugin-vue-router`ã€‚

    ```bash
    npm install -D unplugin-vue-router
    # æˆ–
    yarn add -D unplugin-vue-router
    # æˆ–
    pnpm add -D unplugin-vue-router
    ```

2.  **é…ç½® Vite**
    åœ¨ä½ çš„ `vite.config.ts` ä¸­å¼•å…¥å¹¶é…ç½®æ’ä»¶ã€‚**å…³é”®ç‚¹ï¼š`VueRouter()` å¿…é¡»æ”¾åœ¨ `vue()` æ’ä»¶ä¹‹å‰**ã€‚

    ```javascript
    // vite.config.ts
    import { defineConfig } from 'vite'
    import vue from '@vitejs/plugin-vue'
    import VueRouter from 'unplugin-vue-router/vite' // å¼•å…¥æ’ä»¶

    export default defineConfig({
      plugins: [
        // é…ç½® unplugin-vue-router
        VueRouter({
          /* æ’ä»¶é€‰é¡¹ï¼Œä¾‹å¦‚ routesFolder: 'src/pages' */
        }),
        vue(), // ç¡®ä¿ vue() åœ¨ VueRouter() ä¹‹å
      ],
    })
    ```

3.  **æ›´æ–° TypeScript é…ç½®**
    ä¸ºäº†è®© TypeScript è¯†åˆ«è‡ªåŠ¨ç”Ÿæˆçš„è·¯ç”±ç±»å‹ï¼Œåœ¨ `env.d.ts` æˆ–ç±»ä¼¼ç±»å‹å£°æ˜æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å¼•ç”¨ï¼š

    ```typescript
    /// <reference types="vite/client" />
    /// <reference types="unplugin-vue-router/client" /> // æ·»åŠ è¿™è¡Œ
    ```

4.  **ä¿®æ”¹è·¯ç”±æ–‡ä»¶**
    ä½ åŸæœ¬æ‰‹åŠ¨åˆ›å»ºè·¯ç”±çš„æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ `src/router/index.ts`ï¼‰å¯ä»¥ç®€åŒ–ä¸ºï¼š

    ```typescript
    // src/router/index.ts
    import { createRouter, createWebHistory } from 'vue-router/auto' // æ³¨æ„æ˜¯ä» 'vue-router/auto' å¯¼å…¥
    // æ’ä»¶ä¼šè‡ªåŠ¨ç”Ÿæˆ routes æ•°ç»„
    import { routes } from 'vue-router/auto-routes'

    const router = createRouter({
      history: createWebHistory(),
      routes, // ä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆçš„è·¯ç”±é…ç½®
    })

    export default router
    ```

5.  **ç¡®ä¿ App.vue ä½¿ç”¨ RouterView**
    ä½ çš„ `src/App.vue` éœ€è¦åŒ…å« `<RouterView />` æ¥æ˜¾ç¤ºé¡µé¢ç»„ä»¶ã€‚

    ```vue
    <!-- src/App.vue -->
    <template>
      <RouterView />
    </template>
    ```

### ğŸ“ ä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆçš„è·¯ç”±

é…ç½®å®Œæˆåï¼Œ**`src/pages`** ç›®å½•ä¸‹çš„ `.vue` æ–‡ä»¶ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºè·¯ç”±ã€‚
*   **åŸºæœ¬è·¯ç”±**ï¼š`src/pages/index.vue` å¯¹åº”è·¯ç”± `/`ï¼Œ`src/pages/about.vue` å¯¹åº”è·¯ç”± `/about`ã€‚
*   **åŠ¨æ€è·¯ç”±**ï¼šä½¿ç”¨æ–¹æ‹¬å·å‘½åæ–‡ä»¶å¯ä»¥å®šä¹‰åŠ¨æ€è·¯ç”±ã€‚
    *   `src/pages/users/[id].vue` ç”Ÿæˆè·¯ç”± `/users/:id`ï¼Œåœ¨ç»„ä»¶å†…å¯é€šè¿‡ `const { id } = useRoute().params` è·å–å‚æ•°ã€‚
    *   å¯é€‰å‚æ•°ä½¿ç”¨åŒæ‹¬å·ï¼Œå¦‚ `[[id]]`ã€‚
*   **åµŒå¥—è·¯ç”±**ï¼šåˆ›å»ºçˆ¶å­ç›®å½•ç»“æ„ï¼Œå¹¶åœ¨çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨ `<router-view>`ã€‚
    *   ä¾‹å¦‚ï¼Œ`src/pages/parent.vue` å’Œ `src/pages/parent/child.vue` ä¼šç”ŸæˆåµŒå¥—è·¯ç”± `/parent/child`ã€‚çˆ¶ç»„ä»¶ `parent.vue` ä¸­éœ€è¦åŒ…å« `<router-view/>` æ¥æ¸²æŸ“å­ç»„ä»¶ã€‚
*   **404 è·¯ç”±**ï¼šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶åä¸º `[...404].vue` çš„ç»„ä»¶ï¼Œå®ƒä¼šè¢«ç”¨æ¥åŒ¹é…æ‰€æœ‰æœªå®šä¹‰çš„è·¯ç”±ï¼Œé€šå¸¸ä½œä¸º 404 é¡µé¢ä½¿ç”¨ã€‚

### âš™ï¸ è‡ªå®šä¹‰è·¯ç”±å…ƒä¿¡æ¯

ä½ å¯ä»¥ä½¿ç”¨ `definePage` å®ä¸ºé¡µé¢æ·»åŠ è·¯ç”±å…ƒä¿¡æ¯ï¼ˆmetaï¼‰ï¼Œä¾‹å¦‚é¡µé¢æ ‡é¢˜ã€æ‰€éœ€çš„è®¤è¯æƒé™ç­‰ã€‚

```vue
<script setup>
definePage({
  meta: {
    requiresAuth: true, // è‡ªå®šä¹‰å…ƒä¿¡æ¯
    title: 'ç”¨æˆ·ä¸»é¡µ'
  }
})
// æˆ–è€…ä½¿ç”¨ä»å¤–éƒ¨å¯¼å…¥çš„å˜é‡ï¼ˆæ’ä»¶æ”¯æŒï¼‰
import { appName } from '@/constants'
definePage({
  meta: {
    title: `é¦–é¡µ - ${appName}`
  }
})
// å¦‚æœéœ€è¦æ ¹æ®è·¯ç”±çŠ¶æ€åŠ¨æ€å®šä¹‰å…ƒä¿¡æ¯ï¼Œå¯ä½¿ç”¨å›è°ƒå‡½æ•°
definePage({
  meta: (router) => ({
    title: `é¡¹ç›®: ${router.currentRoute.value.query.code || 'é»˜è®¤æ ‡é¢˜'}`
  })
})
</script>
```

ä¸ºäº†è®© TypeScript è¯†åˆ«è¿™äº›è‡ªå®šä¹‰çš„ `meta` å­—æ®µï¼Œä½ éœ€è¦è¿›è¡Œç±»å‹æ‰©å±•ã€‚åˆ›å»ºä¸€ä¸ªç±»å‹å£°æ˜æ–‡ä»¶ï¼ˆå¦‚ `src/types/typed-router.d.ts`ï¼‰ï¼š

```typescript
import 'vue-router/auto-routes'

declare module 'vue-router/auto-routes' {
  interface RouteMeta {
    /**
     * é¡µé¢æ ‡é¢˜
     */
    title?: string
    /**
     * æ˜¯å¦éœ€è¦è®¤è¯
     */
    requiresAuth?: boolean
    // ... å…¶ä»–ä½ éœ€è¦çš„å­—æ®µ
  }
}
```

### âš ï¸ æ³¨æ„äº‹é¡¹

1.  **æ’ä»¶é¡ºåº**ï¼šåœ¨ `vite.config.ts` ä¸­ï¼Œ`VueRouter()` æ’ä»¶**å¿…é¡»**æ”¾åœ¨ `vue()` æ’ä»¶ä¹‹å‰ã€‚
2.  **æ™ºèƒ½åˆ·æ–°ä¸å¯¼å‡º**ï¼šå¦‚æœä½ ä½¿ç”¨äº†**å®éªŒæ€§**çš„ Data Loaders åŠŸèƒ½å¹¶åœ¨åŠ¨æ€è·¯ç”±ï¼ˆå¦‚ `[id].vue`ï¼‰ä¸­ï¼Œä¸ºäº†ç¡®ä¿å‚æ•°å˜åŒ–æ—¶æ•°æ®åŠ è½½å™¨èƒ½é‡æ–°æ‰§è¡Œï¼Œ**å¿…é¡»å°† Data Loader ä»é¡µé¢ç»„ä»¶ä¸­å¯¼å‡º**ã€‚
3.  **è‡ªå®šä¹‰è·¯ç”±**ï¼šå¦‚æœè‡ªåŠ¨ç”Ÿæˆçš„è·¯ç”±æ— æ³•æ»¡è¶³ç‰¹æ®Šéœ€æ±‚ï¼ˆå¦‚éå¸¸ç‰¹æ®Šçš„è·¯å¾„æˆ–å¤æ‚é€»è¾‘ï¼‰ï¼Œä½ ä»ç„¶å¯ä»¥**åœ¨ `routes` æ•°ç»„ä¸­æ‰‹åŠ¨æ·»åŠ è‡ªå®šä¹‰è·¯ç”±**ï¼Œå¹¶ä¸è‡ªåŠ¨ç”Ÿæˆçš„è·¯ç”±ä¸€èµ·ä½¿ç”¨ã€‚

    ```typescript
    // src/router/index.ts
    import { createRouter, createWebHistory } from 'vue-router/auto'
    import { routes } from 'vue-router/auto-routes'
    // å¼•å…¥è‡ªå®šä¹‰ç»„ä»¶
    import CustomComponent from '@/views/CustomComponent.vue'

    const router = createRouter({
      history: createWebHistory(),
      routes: [
        ...routes, // å±•å¼€è‡ªåŠ¨ç”Ÿæˆçš„è·¯ç”±
        // æ·»åŠ è‡ªå®šä¹‰è·¯ç”±
        {
          path: '/custom',
          component: CustomComponent,
          meta: { requiresAuth: false }
        }
      ],
    })

    export default router
    ```
4.  **å®éªŒæ€§åŠŸèƒ½**ï¼šä¸€äº›é«˜çº§åŠŸèƒ½ï¼ˆå¦‚ Data Loadersï¼‰ä»æ ‡è®°ä¸ºå®éªŒæ€§ï¼ŒAPI å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨éœ€ç•™æ„ã€‚

### ğŸ’¡ æ ¸å¿ƒä¼˜åŠ¿

Unplugin Vue Router çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š
*   **å¼€å‘æ•ˆç‡æå‡**ï¼šæ— éœ€æ‰‹åŠ¨ç¼–å†™å’Œç»´æŠ¤è·¯ç”±é…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶å³è·¯ç”±ã€‚
*   **ç±»å‹å®‰å…¨**ï¼šä¸ TypeScript æ— ç¼é›†æˆï¼Œæä¾›ä¼˜ç§€çš„ç±»å‹æç¤ºå’Œè‡ªåŠ¨è¡¥å…¨ï¼Œå‡å°‘é”™è¯¯ã€‚
*   **çº¦å®šä¼˜äºé…ç½®**ï¼šéµå¾ªç®€å•çš„æ–‡ä»¶å‘½åçº¦å®šå³å¯æ”¯æŒåŠ¨æ€è·¯ç”±ã€åµŒå¥—è·¯ç”±ã€404 è·¯ç”±ç­‰å¤æ‚åœºæ™¯ã€‚
*   **çƒ­æ›´æ–°æ”¯æŒ**ï¼šåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ·»åŠ ã€åˆ é™¤æˆ–ä¿®æ”¹é¡µé¢æ–‡ä»¶éƒ½ä¼šè‡ªåŠ¨æ›´æ–°è·¯ç”±é…ç½®ã€‚

å¸Œæœ›è¿™ä»½åŸºç¡€ä½¿ç”¨è¯´æ˜èƒ½å¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ Unplugin Vue Routerï¼Œäº«å—æ›´æµç•…çš„è·¯ç”±å¼€å‘ä½“éªŒã€‚æ›´è¯¦ç»†çš„é…ç½®å’Œé«˜çº§ç”¨æ³•è¯·å‚è€ƒå…¶å®˜æ–¹æ–‡æ¡£ã€‚