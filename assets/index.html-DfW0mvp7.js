import{_ as d,c as k,d as p,a as r,b as s,w as i,r as h,o,e as l}from"./app-BN04xNHl.js";const c={},g={class:"vp-file-tree"};function m(v,a){const t=h("VPCopyButton"),e=h("VPIcon"),n=h("FileTreeNode");return o(),k("div",null,[a[6]||(a[6]=p('<h2 id="一、什么是-monorepo" tabindex="-1"><a class="header-anchor" href="#一、什么是-monorepo"><span>一、什么是 Monorepo?</span></a></h2><p>Monorepo (单一代码库)是一种项目管理方式，将多个相关项目放在同一个代码仓库中管理，具有以下优势：</p><ul><li>可以提取公共代码作为公共包，在项目之间共享。</li><li>统一管理所有项目的依赖</li><li>跨项目变更更加方便</li><li>统一代码风格和构建流程</li><li>一次修改，可以更新所有关联代码</li></ul><h2 id="二、pnpm-workspace" tabindex="-1"><a class="header-anchor" href="#二、pnpm-workspace"><span>二、PNPM Workspace</span></a></h2><p><code>pnpm workspace</code> 是 pnpm 提供的 <code>Monorepo</code>（单体仓库）管理方案，允许在单个代码仓库中管理多个项目（包），并高效共享依赖。相比 <code>npm/yarn workspace</code>，pnpm 通过 <mark>硬链接</mark> 节省磁盘空间，依赖管理更高效。</p><ul><li>Workspace（工作区）：一个包含多个子项目的根目录，通过 <code>pnpm-workspace.yaml</code> 定义。</li><li>共享依赖：所有子项目共用 <code>node_modules</code>，避免重复安装。</li><li>依赖提升：将共用的依赖提升到根目录的 <code>node_modules</code>，减少冗余。</li><li>跨项目引用：子项目之间可以通过 <code>workspace:*</code> 引用，无需指定版本号。</li></ul><h2 id="三、配置一个-monorepo-项目" tabindex="-1"><a class="header-anchor" href="#三、配置一个-monorepo-项目"><span>三、配置一个 Monorepo 项目</span></a></h2><h3 id="_1-初始化项目结构" tabindex="-1"><a class="header-anchor" href="#_1-初始化项目结构"><span>1. 初始化项目结构</span></a></h3><p>典型的 monorepo 结构：</p>',9)),r("div",g,[s(t,{text:"eJzT43o0ZcqjKQ1ApJBbqZubn5dflFqQz6UABI+mzIHKFCQmZyemp+plFefnoUvlFeTqlucXZRcDFaXqVSbm5mDXXAwVbkKRLM1EEYaQMAdhsRZVQWlJZg6yuRAWHu0wqcSCAog+VOHy1CS4KG6zAFPPfpE=",encode:"","aria-label":"复制","data-copied":"已复制"}),s(n,{expanded:"",type:"folder",filename:"my-monorepo",level:0},{icon:i(()=>[s(e,{provider:"iconify",name:"vscode-icons:default-folder"})]),default:i(()=>[s(n,{type:"file",filename:"package.json",level:1},{icon:i(()=>[s(e,{provider:"iconify",name:"vscode-icons:file-type-node"})]),_:1}),s(n,{type:"file",filename:"pnpm-workspace.yaml",level:1},{icon:i(()=>[s(e,{provider:"iconify",name:"vscode-icons:file-type-light-pnpm"})]),comment:i(()=>[...a[0]||(a[0]=[l("# 工作空间配置文件",-1)])]),_:1}),s(n,{expanded:"",type:"folder",filename:"packages",level:1},{icon:i(()=>[s(e,{provider:"iconify",name:"vscode-icons:folder-type-package"})]),comment:i(()=>[...a[1]||(a[1]=[l("# 抽离的公共组件、公共方法",-1)])]),default:i(()=>[s(n,{expanded:"",type:"folder",filename:"ui",level:2},{icon:i(()=>[s(e,{provider:"iconify",name:"vscode-icons:default-folder"})]),comment:i(()=>[...a[2]||(a[2]=[l("# 子项目 1",-1)])]),default:i(()=>[s(n,{type:"file",filename:"package.json",level:3},{icon:i(()=>[s(e,{provider:"iconify",name:"vscode-icons:file-type-node"})]),_:1})]),_:1}),s(n,{expanded:"",type:"folder",filename:"utils",level:2},{icon:i(()=>[s(e,{provider:"iconify",name:"vscode-icons:folder-type-tools"})]),comment:i(()=>[...a[3]||(a[3]=[l("# 子项目 2",-1)])]),default:i(()=>[s(n,{type:"file",filename:"package.json",level:3},{icon:i(()=>[s(e,{provider:"iconify",name:"vscode-icons:file-type-node"})]),_:1})]),_:1})]),_:1}),s(n,{expanded:"",type:"folder",filename:"apps",level:1},{icon:i(()=>[s(e,{provider:"iconify",name:"vscode-icons:folder-type-app"})]),comment:i(()=>[...a[4]||(a[4]=[l("# 具体的项目",-1)])]),default:i(()=>[s(n,{expanded:"",type:"folder",filename:"web",level:2},{icon:i(()=>[s(e,{provider:"iconify",name:"vscode-icons:folder-type-public"})]),comment:i(()=>[...a[5]||(a[5]=[l("# 应用 1",-1)])]),default:i(()=>[s(n,{type:"file",filename:"package.json",level:3},{icon:i(()=>[s(e,{provider:"iconify",name:"vscode-icons:file-type-node"})]),_:1})]),_:1})]),_:1})]),_:1})]),a[7]||(a[7]=p(`<h3 id="_2-配置-pnpm-workspace-yaml" tabindex="-1"><a class="header-anchor" href="#_2-配置-pnpm-workspace-yaml"><span>2. 配置 <code>pnpm-workspace.yaml</code></span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">packages</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 所有在 packages/ 和 apps/ 下的子目录都是工作区包</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  -</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">packages/**</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  -</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">apps/**</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 排除特定目录</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  -</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">!**/test/**</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-根目录-package-json" tabindex="-1"><a class="header-anchor" href="#_3-根目录-package-json"><span>3. 根目录 <code>package.json</code></span></a></h3><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">name</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">my-monorepo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">private</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 私有属性，防止直接安装</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">scripts</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">    &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">build</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pnpm -r run build</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // -r 表示递归执行所有子项目</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">    &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">test</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pnpm -r run test</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="四、核心功能与使用" tabindex="-1"><a class="header-anchor" href="#四、核心功能与使用"><span>四、核心功能与使用</span></a></h2><h3 id="_1-安装所有工作区依赖" tabindex="-1"><a class="header-anchor" href="#_1-安装所有工作区依赖"><span>1. 安装所有工作区依赖</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 安装所有工作区项目的依赖</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 等价于</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> multi</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-添加依赖到特定工作区" tabindex="-1"><a class="header-anchor" href="#_2-添加依赖到特定工作区"><span>2. 添加依赖到特定工作区</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 为 packages/ui 添加 lodash 依赖</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> lodash</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --filter</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ui</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 添加工作区的 util 包作为 web 的依赖</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> util</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --filter</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --workspace</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-运行工作区命令" tabindex="-1"><a class="header-anchor" href="#_3-运行工作区命令"><span>3. 运行工作区命令</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 在所有工作区运行 build 命令</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -r</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 在特定工作区运行命令</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --filter</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ui</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dev</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 并行运行命令</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -r</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --parallel</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dev</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-依赖管理特性" tabindex="-1"><a class="header-anchor" href="#_4-依赖管理特性"><span>4. 依赖管理特性</span></a></h3><ul><li><strong>提升(Hoisting)</strong>：默认将依赖提升到根 node_modules</li><li><strong>严格模式</strong>：防止非法访问未声明的依赖</li><li><strong>交叉链接</strong>：工作区包相互引用使用符号链接</li></ul><h2 id="五、高级用法" tabindex="-1"><a class="header-anchor" href="#五、高级用法"><span>五、高级用法</span></a></h2><h3 id="_1-工作区协议-workspace" tabindex="-1"><a class="header-anchor" href="#_1-工作区协议-workspace"><span>1. 工作区协议(workspace:)</span></a></h3><p>在 package.json 中引用工作区内其他包：</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">dependencies</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">    &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">shared-utils</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">workspace:^1.0.0</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">    &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">ui-components</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">workspace:*</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">  #</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;"> 总是使用最新版本</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-选择性安装" tabindex="-1"><a class="header-anchor" href="#_2-选择性安装"><span>2. 选择性安装</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 只在特定工作区安装指定依赖</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dependencies</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --filter</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> workspace_name</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-发布管理" tabindex="-1"><a class="header-anchor" href="#_3-发布管理"><span>3. 发布管理</span></a></h3><p>使用 <code>changesets</code> 进行版本管理和发布：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 安装 changesets</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -Dw</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> @changesets/cli</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 初始化</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> changeset</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> init</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 添加变更</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> changeset</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 版本升级和发布</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> changeset</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> version</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> publish</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -r</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-任务管道" tabindex="-1"><a class="header-anchor" href="#_4-任务管道"><span>4. 任务管道</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 按照拓扑顺序构建 (先构建依赖项)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pnpm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --recursive</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --filter=...</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> build</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="六、最佳实践" tabindex="-1"><a class="header-anchor" href="#六、最佳实践"><span>六、最佳实践</span></a></h2><ol><li><strong>统一版本</strong>：使用 <code>workspace:*</code> 保持工作区内包版本同步</li><li><strong>最小化公共依赖</strong>：将公共依赖放在根 package.json</li><li><strong>清晰的目录结构</strong>：如 <code>packages/</code> 放库，<code>apps/</code> 放应用</li><li><strong>CI 优化</strong>：只安装和构建受影响的工作区</li><li><strong>文档规范</strong>：维护清晰的 monorepo 开发文档</li></ol><h2 id="常见问题解决" tabindex="-1"><a class="header-anchor" href="#常见问题解决"><span>常见问题解决</span></a></h2><h3 id="问题-1-如何解决工作区之间的循环依赖" tabindex="-1"><a class="header-anchor" href="#问题-1-如何解决工作区之间的循环依赖"><span>问题 1：如何解决工作区之间的循环依赖？</span></a></h3><p><strong>方案</strong>：重构代码消除循环依赖，或提取公共部分到新包</p><h3 id="问题-2-某些包需要不同的-node-js-版本" tabindex="-1"><a class="header-anchor" href="#问题-2-某些包需要不同的-node-js-版本"><span>问题 2：某些包需要不同的 Node.js 版本？</span></a></h3><ul><li><strong>方案</strong>：使用 <code>.npmrc</code> 配置 <code>use-node-version</code> 或工具如 <code>nvm</code>/<code>fnm</code></li></ul><h3 id="问题-3-如何限制某些包的访问" tabindex="-1"><a class="header-anchor" href="#问题-3-如何限制某些包的访问"><span>问题 3：如何限制某些包的访问？</span></a></h3><ul><li><strong>方案</strong>：使用 <code>pnpm.overrides</code> 或 <code>resolutions</code> 统一版本</li></ul><p>PNPM 的工作区功能为 monorepo 提供了高效、可靠的解决方案，特别适合大型项目和多包管理的场景。</p>`,34))])}const u=d(c,[["render",m]]),A=JSON.parse('{"path":"/notes/Pnpm/gev42fjw/","title":"1. PNPM Workspace 与 Monorepo 详解 | Pnpm","lang":"zh-CN","frontmatter":{"title":"1. PNPM Workspace 与 Monorepo 详解","createTime":"2025/06/14 00:04:09","permalink":"/notes/Pnpm/gev42fjw/"},"readingTime":{"minutes":3.28,"words":984},"git":{"createdTime":1749980593000,"updatedTime":1764524144000,"contributors":[{"name":"kangkang shang","username":"","email":"535634238@qq.com","commits":2,"avatar":"https://gravatar.com/avatar/899a2a8091fc73ff6879f8a45f98a5a42ca8b9665bca19ce8af3a144e416ed11?d=retro"}],"changelog":[{"hash":"37a5215b25a66c978fe447e5ce9d1d1acc9adaad","time":1764524144000,"email":"535634238@qq.com","author":"kangkang shang","message":"docs: 更新文档结构和内容"},{"hash":"715e3ed1fb9d8039c875ea7244e5305946ce84cc","time":1749980593000,"email":"535634238@qq.com","author":"kangkang shang","message":"1"}]},"filePathRelative":"notes/Pnpm/1.workspace.md","headers":[],"bulletin":false}');export{u as comp,A as data};
